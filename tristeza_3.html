<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tristeza</title>

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="css/styles.css">

    <style>
        html, body {
            margin: 0; padding: 0;
            width: 100%; height: 100%;
            overflow: hidden;
        }

        body.tristeza {
            position: relative;
            background: linear-gradient(180deg, #4A5568, #2D3748, #1A202C, #718096);
            background-size: 400% 400%;
            animation: cloudyWaves 12s ease infinite;
            color: #EDF2F7;
        }

        @keyframes cloudyWaves {
            0%{background-position:0% 0%;}
            50%{background-position:100% 100%;}
            100%{background-position:0% 0%;}
        }

        #rain-canvas, .lightning { position: fixed; top:0; left:0; width:100%; height:100%; pointer-events:none; }

        .lightning { background: rgba(255,255,255,0.8); opacity:0; z-index:5; }

        .raindrop {
            position:absolute;
            background: linear-gradient(to bottom, rgba(174,194,224,0.6), rgba(174,194,224,0.2));
            width:2px; border-radius:50%;
            animation: fall linear infinite;
        }

        @keyframes fall {
            to { transform:translateY(100vh); opacity:0; }
        }

        .ripple {
            position:absolute;
            border:2px solid rgba(174,194,224,0.4);
            border-radius:50%;
            pointer-events:none;
            animation:rippleEffect 1s ease-out forwards;
        }

        @keyframes rippleEffect {
            0%{width:0;height:0;opacity:1;}
            100%{width:40px;height:40px;opacity:0;}
        }

        .bolt {
            position:absolute;
            width:3px;
            background:linear-gradient(to bottom,rgba(255,255,255,0.9),rgba(200,220,255,0.6));
            opacity:0; pointer-events:none; z-index:6;
        }

        .bolt.strike { animation: boltStrike .3s ease-out; }

        @keyframes boltStrike { 0%,100%{opacity:0;} 50%{opacity:1;} }

        .lightning.flash { animation: lightningFlash .4s ease-out; }

        @keyframes lightningFlash {
            0%,20%,40%,100%{opacity:0;}
            10%,30%{opacity:.8;}
        }

        .contenido {
            position:relative;
            z-index:10;
            background:rgba(15,23,42,.65);
            padding:2rem;
            margin-top:4rem;
            border-radius:1rem;
        }
    </style>
</head>
<body class="tristeza">

<!-- lluvia y rayos -->
<div id="rain-canvas"></div>
<div class="lightning" id="lightning"></div>

<!-- Howler.js CDN -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/howler/2.2.4/howler.min.js"></script>

<!-- Contenido -->
<div class="container">
    <div class="row">
        <div class="col-md-8 offset-md-2">
            <div class="contenido">
                <h1>Tristeza</h1>
                <p>La tristeza es una emoci√≥n que nos ayuda a procesar p√©rdidas y dificultades.</p>
                <button class="boton-volver" onclick="window.location.href='alegria_2.html'">P√°gina anterior</button>
                <button class="boton-siguiente" onclick="window.location.href='ira_4.html'">Siguiente p√°gina ‚Üí</button>
            </div>
        </div>
    </div>
</div>

<script>
    // ------------------------
    // üéµ AUDIO CON HOWLER
    // ------------------------
    // Coloca un archivo peque√±o, por ejemplo "tristeza.mp3",
    // dentro de una carpeta "audio" en tu proyecto.
    let bgMusic = new Howl({
        src: ["audio/tristeza.mp3"],   // archivo local ‚Üí carga r√°pida y confiable
        loop: true,
        volume: 0.4,
        preload: 'auto',              // lo carga apenas se pueda
        html5: true                   // usa audio HTML5 para mejor compatibilidad
    });

    let clickSound = new Howl({
        src: ["https://assets.codepen.io/21542/sound-rise-01.mp3"],
        volume: 0.7
    });

    let started = false;

    function startMusic() {
        if (!started) {
            bgMusic.play();
            started = true;
        }
    }

    // activa m√∫sica apenas el usuario toque la pantalla o clic
    document.addEventListener("click", startMusic, { once: true });
    document.addEventListener("touchstart", startMusic, { once: true });

    // sonido clic botones
    document.addEventListener("DOMContentLoaded", () => {
        document.querySelectorAll(".boton-siguiente, .boton-volver").forEach(btn => {
            btn.addEventListener("click", () => clickSound.play());
        });
    });
</script>

<!-- üåßÔ∏è lluvia + rayos -->
<script>
    document.addEventListener('DOMContentLoaded', () => {
        const canvas = document.getElementById('rain-canvas');
        const lightning = document.getElementById('lightning');
        if (!canvas || !lightning) return;

        const raindrops=[];
        let numDrops=80, darkness=0;

        class Raindrop {
            constructor() {
                this.el=document.createElement('div');
                this.el.className='raindrop';
                this.reset();
                canvas.appendChild(this.el);
            }
            reset() {
                this.x=Math.random()*innerWidth;
                this.y=-Math.random()*innerHeight;
                this.length=Math.random()*20+15;
                this.speed=Math.random()*2+3;
                this.opacity=Math.random()*0.3+0.3;

                this.el.style.left=this.x+"px";
                this.el.style.top=this.y+"px";
                this.el.style.height=this.length+"px";
                this.el.style.opacity=this.opacity;
                this.el.style.animationDuration=this.speed+"s";
            }
            update() {
                const t=this.el.style.transform;
                if(t){
                    const m=t.match(/translateY\(([^)]+)px\)/);
                    const v=m?parseFloat(m[1]):0;
                    if(v>=innerHeight){
                        this.reset();
                    }
                }
            }
        }

        for(let i=0;i<numDrops;i++){
            setTimeout(()=>raindrops.push(new Raindrop()), i*30);
        }

        function animate(){
            raindrops.forEach(d=>d.update());
            requestAnimationFrame(animate);
        }
        animate();

        function createBolt(){
            const bolt=document.createElement('div');
            bolt.className='bolt';
            const x=Math.random()*innerWidth;
            const h=Math.random()*300+200;
            bolt.style.left=x+"px";
            bolt.style.height=h+"px";
            bolt.style.top="0px";
            bolt.classList.add("strike");
            document.body.appendChild(bolt);
            setTimeout(()=>bolt.remove(),300);
        }

        function lightningFlash(){
            lightning.classList.add("flash");
            setTimeout(()=>lightning.classList.remove("flash"),400);

            const n=Math.floor(Math.random()*3)+1;
            for(let i=0;i<n;i++){
                setTimeout(()=>createBolt(), i*50);
            }

            const next=Math.random()*5000+3000;
            setTimeout(lightningFlash, next);
        }

        // activar rayos y aumentar lluvia
        document.body.addEventListener("click", ()=>{
            lightningFlash();
            darkness=Math.min(darkness+0.1,0.7);
            document.body.style.filter=`brightness(${1-darkness})`;
        });
    });
</script>

</body>
</html>
